version: '2'
services:
  zk1:
    build: 
      context: zookeeper
    volumes:
      - /etc/localtime:/etc/localtime
      - zk1-data:/opt/zookeeper/zk-data
      - zk1-log:/opt/zookeeper/zk-log
    environment:
      - ZK_ID=1
      - ZK_SERVER_2=2:zk-zk2-1.zk-zk2.docker:2888:3888
      - ZK_SERVER_3=3:zk-zk3-1.zk-zk3.docker:2888:3888
    network_mode: "bridge"
  zk2:
    build: 
      context: zookeeper
    volumes:
      - /etc/localtime:/etc/localtime
      - zk2-data:/opt/zookeeper/zk-data
      - zk2-log:/opt/zookeeper/zk-log
    environment:
      - ZK_ID=2
      - ZK_SERVER_1=1:zk-zk1-1.zk-zk1.docker:2888:3888
      - ZK_SERVER_3=3:zk-zk3-1.zk-zk3.docker:2888:3888
    network_mode: "bridge"
  zk3:
    build: 
      context: zookeeper
    volumes:
      - /etc/localtime:/etc/localtime
      - zk3-data:/opt/zookeeper/zk-data
      - zk3-log:/opt/zookeeper/zk-log
    environment:
      - ZK_ID=3
      - ZK_SERVER_1=1:zk-zk1-1.zk-zk1.docker:2888:3888
      - ZK_SERVER_2=2:zk-zk2-1.zk-zk2.docker:2888:3888
    network_mode: "bridge"
volumes:
  zk1-data:
  zk1-log:
  zk2-data:
  zk2-log:
  zk3-data:
  zk3-log: